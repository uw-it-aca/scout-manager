{% load user_agents %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <title>{% block title %}{% endblock %} &middot; Scout Manager</title>
        {% include "scout_manager/include/head.html" %}
    </head>
    <body {% if request.user_agent.is_mobile or request.user_agent.is_tablet %}data-mobile="true"{% endif %}>
        <div id="header" class="mgr-header" role="banner" aria-labelledby="app_header">
            <h1 id="app_header"><a href="/manager/">Scout<span>Manager</span></a></h1>
            <span class="mgr-user-name"><span class="visually-hidden">Logged in as: </span>{{ netid }}</span>
            <button onclick="document.getElementById('sidebar').classList.toggle('mgr-sidebar-closed');" type="button" class="btn mgr-menu-button"><i class="fa fa-bars"></i></button>
        </div>

        <div id="sidebar" class="mgr-sidebar {% if request.user_agent.is_mobile or request.user_agent.is_tablet %}mgr-sidebar-closed{% endif %}">
            <h2 class="visually-hidden" id="navigation_header">Find the spaces and items you manage:</h2>
            <div class="mgr-sidebar-actions" role="navigation" aria-labelledby="navigation_header">
                <h3 id="subheader_spaces" ><small class="text-muted" style="padding: 15px 20px 0 20px; display:block;">Spaces</small></h3>
                <ul aria-labelledby="subheader_spaces">
                    <li><a class="" href="/manager/">View All Spaces</a></li>
                    <li><a class="" href="/manager/spaces/?app_type=food" title="View the food spaces you manage"><i class="fa fa-cutlery" aria-hidden="true"></i> Food</a></li>
                    <li><a class="" href="/manager/spaces/?app_type=study" title="View the study spaces you manage"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Study</a></li>
                    <li><a class="" href="/manager/spaces/?app_type=tech" title="View the tech spaces you manage"><i class="fa fa-laptop" aria-hidden="true"></i> Tech</a></li>
                </ul>
                <ul style="font-weight:400;">
                    <li><a href="/manager/spaces/add/" role="button" title="Create new space"><i class="fa fa-plus" aria-hidden="true"></i> Add New Space</a></li>
                    <!--<li><a href="/manager/spaces/upload/"><i class="fa fa-upload" aria-hidden="true"></i> Upload Spaces</a></li>-->
                </ul>
                <h3 id="subheader_items"><small class="text-muted" style="padding: 15px 20px 0 20px; display:block;">Items</small></h3>
                <ul aria-labelledby="subheader_items">
                    <li><a class="" href="/manager/items/" title="View all the tech items you manage"><i class="fa fa-laptop" aria-hidden="true"></i> View All Items</a></li>
                </ul>
            </div>
        </div>

        <div id="content" class="mgr-content" role="main" aria-labelledby="sub_header" style="padding-top: 20px">
            <div class="mgr-content-inner container-fluid">
                <div id="alert-retirement" class="alert alert-info" role="alert" style="margin: 20px; z-index:2;"><span class="close" style="float: right; cursor: pointer; font-size: 20px; line-height: 20px; margin-left: 15px; color: inherit;">&times;</span><span style="font-weight: bold">Important Notice:</span> UW Scout will be retired on <span style="font-weight: bold">March 20, 2026</span>. The iOS and Android apps have already been removed from their respective app stores. Going forward, support will be limited to maintaining current functionality only; no new features or changes will be accepted.</div>
                {% block web_content %}{% endblock %}
            </div>
        </div>

        <div id="footer" class="mgr-footer" role="contentinfo">
            <p>Copyright &copy; {% now "Y" %}  <span>Courtesy of UW-IT AXDD</span><span style="float:right;"><a href="mailto:help@uw.edu">Contact Support</a></span><span><a href="http://www.washington.edu/online/privacy/" title="UW Privacy Policy">Privacy</a></span> <span><a href="http://www.washington.edu/online/terms/" title="UW terms of use policy">Terms</a></span></p>
        </div>

        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            // Select the specific alert element. Use the unique ID we added.
            const alertElement = document.getElementById('alert-retirement'); // Use the ID you set in HTML

            if (alertElement) { // Only proceed if the alert element exists
                const alertId = alertElement.id || alertElement.dataset.alertId;
                const localStorageKey = `dismissedAlert_${alertId}`;

                // Function to handle dismissal and persist to localStorage
                const dismissAlert = function() {
                    alertElement.style.display = 'none'; // Or alertElement.classList.add('hidden'); if using CSS class
                    localStorage.setItem(localStorageKey, 'true');
                };

                // Check if the alert was previously dismissed on page load
                if (localStorage.getItem(localStorageKey) === 'true') {
                    alertElement.style.display = 'none'; // Or alertElement.classList.add('hidden');
                } else {
                    // Ensure the close button exists and attach the event listener
                    let closeButton = alertElement.querySelector('.close');

                    // If for some reason the close button isn't in the HTML, create it dynamically
                    if (!closeButton) {
                        closeButton = document.createElement('span');
                        closeButton.classList.add('close');
                        closeButton.innerHTML = '&times;';
                        alertElement.prepend(closeButton);
                        // Note: If dynamically creating, you'd also need to apply its styles here
                        // or ensure your CSS rules are robust enough to style it.
                    }

                    // Attach the event listener to the close button
                    closeButton.addEventListener('click', dismissAlert);
                }
            }
        });
        </script>

    </body>
</html>
